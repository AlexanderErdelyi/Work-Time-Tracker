<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timekeeper - Time Tracking Application</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div id="toast-container"></div>
    <div class="container">
        <header>
            <div style="position: relative;">
                <h1>‚è±Ô∏è Timekeeper</h1>
                <button id="settings-btn" class="settings-btn" title="Settings">‚öôÔ∏è</button>
            </div>
            <p>Track your time efficiently</p>
        </header>

        <!-- Timer Section -->
        <section class="timer-section card">
            <h2>Timer Control</h2>
            <div id="timer-display" class="timer-display">
                <span id="timer-time">00:00:00</span>
            </div>
            <div id="timer-info" class="timer-info" style="display: none;">
                <p><strong>Task:</strong> <span id="running-task-name"></span></p>
                <p><strong>Project:</strong> <span id="running-project-name"></span></p>
                <p><strong>Customer:</strong> <span id="running-customer-name"></span></p>
            </div>
            <div class="timer-controls">
                <div id="start-timer-form">
                    <label for="timer-task-search">Select Task:</label>
                    <div class="task-search-wrapper">
                        <input type="text" id="timer-task-search" class="form-control" placeholder="Search tasks, projects, or customers..." autocomplete="off">
                        <div id="timer-task-dropdown" class="task-dropdown"></div>
                    </div>
                    <select id="timer-task-select" style="display: none;">
                        <option value="">-- Select a task --</option>
                    </select>
                    <textarea id="timer-notes" class="form-control" placeholder="Notes (optional)" rows="2"></textarea>
                    <button id="start-timer-btn" class="btn btn-primary" disabled>Start Timer</button>
                </div>
                <div id="stop-timer-form" style="display: none;">
                    <button id="stop-timer-btn" class="btn btn-danger">Stop Timer</button>
                </div>
            </div>
        </section>

        <!-- Navigation Tabs -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="entries">Time Entries</button>
            <button class="tab-btn" data-tab="customers">Customers</button>
            <button class="tab-btn" data-tab="projects">Projects</button>
            <button class="tab-btn" data-tab="tasks">Tasks</button>
            <button class="tab-btn" data-tab="reports">Reports</button>
        </nav>

        <!-- Time Entries Tab -->
        <section id="entries-tab" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <h2>Time Entries</h2>
                    <button id="add-entry-btn" class="btn btn-primary">+ New Entry</button>
                </div>
                
                <!-- Filters -->
                <div class="filters">
                    <input type="date" id="entry-start-date" class="form-control" placeholder="Start Date">
                    <input type="date" id="entry-end-date" class="form-control" placeholder="End Date">
                    <select id="entry-customer-filter" class="form-control">
                        <option value="">All Customers</option>
                    </select>
                    <select id="entry-project-filter" class="form-control">
                        <option value="">All Projects</option>
                    </select>
                    <select id="entry-task-filter" class="form-control">
                        <option value="">All Tasks</option>
                    </select>
                    <input type="text" id="entry-search" class="form-control" placeholder="Search...">
                    <button id="filter-entries-btn" class="btn btn-secondary">Apply Filters</button>
                    <button id="clear-filters-btn" class="btn btn-secondary">Clear</button>
                </div>

                <div class="export-buttons">
                    <button id="export-csv-btn" class="btn btn-secondary">Export CSV</button>
                    <button id="export-xlsx-btn" class="btn btn-secondary">Export XLSX</button>
                </div>

                <table id="entries-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Customer</th>
                            <th>Project</th>
                            <th>Task</th>
                            <th>Start Time</th>
                            <th>End Time</th>
                            <th>Duration</th>
                            <th>Billed Duration</th>
                            <th>Notes</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="entries-tbody">
                        <!-- Entries will be loaded here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Customers Tab -->
        <section id="customers-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Customers</h2>
                    <button id="add-customer-btn" class="btn btn-primary">+ New Customer</button>
                </div>
                <table id="customers-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="customers-tbody">
                        <!-- Customers will be loaded here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Projects Tab -->
        <section id="projects-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Projects</h2>
                    <button id="add-project-btn" class="btn btn-primary">+ New Project</button>
                </div>
                <table id="projects-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Customer</th>
                            <th>Description</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="projects-tbody">
                        <!-- Projects will be loaded here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Tasks Tab -->
        <section id="tasks-tab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Tasks</h2>
                    <button id="add-task-btn" class="btn btn-primary">+ New Task</button>
                </div>
                <table id="tasks-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Project</th>
                            <th>Customer</th>
                            <th>Description</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tasks-tbody">
                        <!-- Tasks will be loaded here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Reports Tab -->
        <section id="reports-tab" class="tab-content">
            <div class="card">
                <h2>Time Reports</h2>
                
                <div class="filters">
                    <input type="date" id="report-start-date" class="form-control" placeholder="Start Date">
                    <input type="date" id="report-end-date" class="form-control" placeholder="End Date">
                    <select id="report-customer-filter" class="form-control">
                        <option value="">All Customers</option>
                    </select>
                    <select id="report-project-filter" class="form-control">
                        <option value="">All Projects</option>
                    </select>
                    <button id="load-reports-btn" class="btn btn-secondary">Load Reports</button>
                </div>

                <h3>Daily Totals</h3>
                <table id="daily-totals-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Total Hours</th>
                            <th>Entry Count</th>
                        </tr>
                    </thead>
                    <tbody id="daily-totals-tbody">
                        <!-- Daily totals will be loaded here -->
                    </tbody>
                </table>

                <h3>Weekly Totals</h3>
                <table id="weekly-totals-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Week Starting</th>
                            <th>Total Hours</th>
                            <th>Entry Count</th>
                        </tr>
                    </thead>
                    <tbody id="weekly-totals-tbody">
                        <!-- Weekly totals will be loaded here -->
                    </tbody>
                </table>
            </div>
        </section>
    </div>

    <!-- Modal for forms -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- Time Summary Toggle Button -->
    <button id="summary-toggle" class="summary-toggle active" onclick="toggleTimeSummary()" title="Toggle Time Summary">
        üìä
    </button>

    <!-- Time Summary Widget -->
    <div id="time-summary" class="time-summary">
        <h3>‚è±Ô∏è Time Summary</h3>
        <div class="summary-item">
            <div class="summary-label">Today</div>
            <div class="summary-value">
                <span class="summary-hours" id="today-hours">0h 0m</span>
                <span class="summary-target">/ <span id="today-target">8h 0m</span></span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="today-progress" style="width: 0%"></div>
            </div>
        </div>
        <div class="summary-item">
            <div class="summary-label">This Week</div>
            <div class="summary-value">
                <span class="summary-hours" id="week-hours">0h 0m</span>
                <span class="summary-target">/ <span id="week-target">40h 0m</span></span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="week-progress" style="width: 0%"></div>
            </div>
        </div>
        <div class="summary-item">
            <div class="summary-label">This Month</div>
            <div class="summary-value">
                <span class="summary-hours" id="month-hours">0h 0m</span>
                <span class="summary-target">/ <span id="month-target">160h 0m</span></span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="month-progress" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <script src="/js/app.js"></script>
</body>
</html>
